---
title: "Sammenhenger mellom inntekt, alder, kjønn og sivilstatus"
author: "Karin Liang, Katinca Valvatne & Frida Alendal"
lang: NO_nb
csl: hvl_apa7_stil_bokmal_v1.csl
bibliography: references.bib
format:
  revealjs: 
    theme: simple
    number-depth: 2
    slide-number: c/t
    toc: true
    toc-depth: 1
    smaller: true
    scrollable: true
    preview-links: auto
    footer: "Presentasjon «Assignment 2» msb105"
    fig-width: 7
slide-number: true
theme: simple
---

## Introduction

Hvilke sammenhenger har vi mellom inntekt, alder, kjønn og sivilstatus? I denne presentasjonen undersøker vi disse sammenhengene i datasettet *modelr::heights*. Tidligere forskning viser at personlige og sosiale kjennetegn ofte henger sammen med økonomisk utbytte. For eksempel finner Judge & Cable (2004) en positiv sammenheng mellom høyde og inntekt, kontrollert for kjønn og alder. Vi vil se om vi kan avdekke lignende mønstre med våre variabler, og hvorvidt kjønn og sivilstatus spiller en rolle for inntektsforskjeller.

I analysen kombinerer vi beskrivende statistikk og grafer for å identifisere mønstre mellom grupper. For eksempel hvordan menn og kvinner, eller gifte og single, skiller seg i gjennomsnittsinntekt, og om alder modererer disse forskjellene.

## Litteraturgjennomgang

Flere studier har tidligere undersøkt hvordan demografiske faktorer som kjønn, sivilstatus og alder påvirker individers inntektsnivå. Et gjennomgående funn i forskningen er at både biologiske og sosiale forskjeller skaper systematiske mønstre i økonomisk utbytte. 

### Kjønn og inntekt
Ifølge @judge2004 viser høyde, som ofte er korrelert med maskuline trekk og sosial status, en positiv sammenheng med karrieresuksess og inntekt. Studien fant at høyere personer i snitt tjener mer, også etter kontroll for kjønn, alder og vekt. Sammenhengen mellom høyde og inntekt forklares blant annet gjennom sosiale mekanismer der høyere personer tilskrives større autoritet og selvtillit, noe som igjen påvirker både jobbpresentasjon og lederfremgang. Selv om effekten var sterkere blant menn enn kvinner, var forskjellen ikke statistisk signifikant, noe som antyder at sosiale oppfatninger om status knyttet til fysiske kjennetegn påvirker begge kjønn. 

### Sivilstatus og økonomisk velstand
@seeborg2004 undersøkte effekten av endringer i sivilstatus på levestandard ved å analysere data som fulgte de samme personene over flere år gjennom *National Longitudinal Survey of Youth (NLSY)*. Studien viser at ekteskap har en positiv effekt på kvinners økonomiske situasjon, mens menn i mindre grad påvirkes. Ved skilsmisse opplever kvinner derimot en betydelig nedgang i sin økonomiske levestandard, mens menn i mange tilfeller opplever en svak økning. Dette forklares gjennom ulik arbeidsdeltakelse, foreldreansvar og kjønnsroller som vedvarer i arbeidsmarkedet. Dermed kan sivilstatus betraktes som en sentral sosial indikator på økonomisk stabilitet, spesielt for kvinner.

### Utdanning, kjønn og inntektsforskjeller
@xie2022 viser at utdanningsnivå har en avgjørende betydning for inntektsnivå, men at kjønnsforskjeller vedvarer selv etter kontroll for utdanning. Menn tjener gjennomgående mer enn kvinner på alle utdanningsnivåer, og dette gapet øker i høyere stillinger. Studien påpeker også at rase og ekteskap påvirker inntekt gjennom sammensatte sosiale mekanismer, der menn oftere drar nytte av tradisjonelle familiemønstre, mens kvinner i større grad bærer økonomiske konsekvenser ved skilsmisse eller delt omsorgsansvar.

### Husholdningsstruktur og sosioøkonomiske profiler
Den nyere studien @mohanneill2014 undersøker hvordan kombinasjonen av kjønn og sivilstatus påvirker husholdningers økonomiske situasjon i USA. Funnene viser at gifte menn har den høyeste samlede inntekten i familien, mens enslige kvinner, særlig de med barn, befinner seg i den mest økonomisk utsatte gruppen. Studien understreker hvordan kjønn og sivilstatus virker sammen og skaper tydelig mønstre i sosioøkonomisk ulikhet mellom husholdninger.  

### Alder og livsløp
Flere økonomiske teorier viser at inntekt typisk følger et livsløp der den øker med alder og erfaring frem til et viss punkt før den flater ut. @seeborg2004 kontrollerte for alder i sine regresjonsmodeller og fant en tydelig positiv sammenheng mellom utdanning, alder og inntekt. Dette støtter teorien om at erfaring og utdanning bygges opp over tid og bidrar til høyere økonomisk utbytte.

### Samlet perspektiv
Når vi kombinerer funnene fra @judge2004, @seeborg2004, @xie2022 og @mohanneill2014, ser vi at inntektforskjeller pårvirkes av både individuelle faktorer (som alder og utdanning) og sosiale faktorer (som kjønn og sivilsatus). Forskningen viser tydelig at kjønn og familieforhold fortsatt har stor betydning for økonomisk velstand, og at effekten av alder og utdanning i mange tilfeller forsterkes eller svekkes av sosiale roller og strukturer. Dette gir et solid teoretisk grunnlag for å analysere sammenhengen mellom inntekt, alder, kjønn og sivilstatus i vårt datasett fra *modelr::heights*. 



## Description of data
::: incremental
-   Første punkt
    - laster inn og rydder datassettet 'heights'
    
### Laster inn og rydder datassettet 'heights' 
```{r}
# andre pakker 
library(dplyr)
library(ggplot2)
library(tidyverse)
library(scales)
library(vtable)
library(flextable)

# laster inn pakken modelr og datasett heights
# install.packages("modelr")
library(modelr)
heights <- modelr::heights
```

Datasettet 'heights' som benyttes i denne oppgaven er hentet fra pakken 'modelr'. Datasettet inneholder informasjon om enkeltpersoner, og består av 7006 observasjoner og 8 variabler: inntekt, høyde, vekt, alder, sivilstatus, kjønn, utdanningsnivå og AFQT-skår. 

```{r}
# viser 
heights
```

Fire variabler, inntekt, alder, kjønn og sivilstatus, er relevante for denne oppgaven.
Før analysen ble variablene i datasettet gitt nye navn, og datasettet ble ryddet ved å fjerne observasjoner med manglende verdier (NA) og nullverdier. De resterende observasjonene utgjør grunnlaget for videre analyse.

```{r}
# rydder datasettet
# rename, inntekt, alder, kjonn, sivilstatus
heights <- heights %>%
  select(income, age, sex, marital) %>%
  rename(
    inntekt = income,
    alder = age,
    kjonn = sex,
    sivilstatus = marital
  ) %>%
  # fjerner NA-verdi og 0-verdi 
  filter(
    !is.na(inntekt), !is.na(alder), !is.na(kjonn), !is.na(sivilstatus),
    inntekt > 0,
    alder > 0
  )
heights

# sjekker igjen struktur og summary
str(heights)
summary(heights)

```

Etter at datasettet ble filtrert og tilpasset analysen, består det nå av 5 266 observasjoner og fire variabler: inntekt, alder, kjønn og sivilstatus.

Resultatene fra summary viser følgende: Inntekt varierer fra 45 til 343 830 USD, med en median på 40 000 USD og et gjennomsnitt på 54 819 USD. Alder varierer mellom 47 og 56 år, med en median på 51 år. Kjønn er jevnt fordelt, med 2 657 menn og 2 609 kvinner. Sivilstatus viser at flertallet (3 101 personer) er gift, mens 710 er single, 1 115 er skilt, 233 separert og 107 enker/enkemenn.

Etter rensingen består datasettet dermed av et balansert og ryddig utvalg som danner grunnlaget for videre beskrivelse og analyse av sammenhengen mellom inntekt, alder, kjønn og sivilstatus.

-   Andre punkt
    - beskrivelse av data
    
### beskriver variabler inntekt og alder
```{r}
# beskrivende statistikk i tabell for de to numeriske variablene: inntekt og alder
heights %>%
  select(inntekt, alder) %>%                # Velger kun de numeriske variablene
  vtable::st(
    data   = .,                             # Bruker det nåværende datasettet
    out    = "return",                      # Returnerer tabellen i stedet for å skrive den ut
    labels = c(
      inntekt = "Inntekt (USD)",
      alder   = "Alder (år)"
    ),
    add.median = TRUE                       # Legger til median i tabellen
  ) %>%
  as_flextable() %>%
  autofit()
```
Denne tabellen viser en deskriptiv oppsummering av de numeriske variablene i datasettet: inntekt og alder.

Gjennomsnittlig inntekt i utvalget er 54 819 USD, med en median på 40 000 USD og en stor spredning (standardavvik på 58 394 USD).  Noen få personer har svært høye inntekter 343 830 USD som trekker gjennomsnittet opp. Alderen varierer mellom 47 og 56 år, med et gjennomsnitt på 51 år.  

Resultatene viser at deltakerne er omtrent like gamle, men at inntektene varierer mye.
```{r}
# figur for å beskrive fordeling av inntekt
fordeling_inntekt <- heights %>%
  ggplot(aes(x = inntekt)) +
  geom_histogram(binwidth = 10000, fill = "skyblue", color = "white") +
  scale_x_continuous(
    breaks = seq(0, 350000, 50000),  # Viser et merke for hver 50 000 USD
    labels = label_number(big.mark = " ", suffix = " USD")
  ) +
  labs(
    title = "Fordeling av inntekt",
    x = "Årlig inntekt (USD)",
    y = "Antall personer"
  ) +
  theme_minimal(base_size = 14) +      # Større tekst for bedre lesbarhet
  theme(
    panel.grid.major = element_line(color = "grey80", linewidth = 0.6),  # Tydelige hovedrutenettlinjer
    panel.grid.minor = element_blank(),                            # Fjerner små rutenettlinjer
    axis.text.x = element_text(angle = 45, hjust = 1)              # Skråstiller teksten på x-aksen for å unngå overlapp
  )
fordeling_inntekt
```

Variabelen inntekt representerer den årlige inntekten (målt i USD) for hver observasjon i datasettet.

Figuren fordeling av inntekt viser hvordan inntekten fordeler seg blant 5 266 personene i datasettet. De fleste observasjonene ligger mellom 20 000 og 80 000 USD, som representerer hovedtyngden av inntektene. Samtidig ser vi at et lite mindretall tjener vesentlig mer enn flertallet. De få personer har svært høye inntekter, helt opp mot over 300 000 USD, noe som trekker gjennomsnittet betydelig opp. Derfor er fordelingen høyreskjev.


```{r}
# Beskrivelse av data(alder)
fordeling_alder <- heights %>%
  ggplot(aes(x = alder)) +
  geom_histogram(binwidth = 1, fill = "mediumaquamarine", color = "white") +
  scale_x_continuous(
    breaks = seq(45, 60, 1)
  ) +
  labs(
    title = "Fordeling av alder",
    x = "Alder (år)",
    y = "Antall personer"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    panel.grid.major = element_line(color = "grey80", linewidth = 0.6),
    panel.grid.minor = element_blank(),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )
fordeling_alder

```

Variabelen alder viser deltakernes alder målt i hele år.

Figuren fordeling av alder viser at aldersfordelingen mellom 47 til 56 år, er jevn og konsentrert innenfor et smalt intervall. De fleste observasjonene ligger mellom 48 og 55 år.Det er få personer som er 47 eller 56 år. Aldersspennet er lite, noe som betyr at de fleste personene i datasettet er omtrent like gamle. 

### beskriver variabler sivilstatus og kjønn
```{r}
# beskrivende statistikk i tabell for de to kategoriske variablene: sivilstatus og kjønn
heights %>%
  select(sivilstatus, kjonn) %>%            # Velger kun de kategoriske variablene
  vtable::st(
    data = ., 
    out = "return",                         # Returnerer tabellen som et objekt
    labels = c(
      sivilstatus = "Sivilstatus",
      kjonn = "Kjønn"
    )
  ) %>%
  as_flextable() %>%
  autofit()
```

Denne tabellen viser en deskriptiv oppsummering av de kategoriske variablene i datasettet: sivilstatus og kjønn.

Flertallet av personene i datasettet er gift (married) — rundt 59 % av utvalget (3 101 personer). 710 personer (13 %) er single, mens 1 115 (21 %) er skilt (divorced). De resterende er separert (233 personer) og enkemann/enke (107 personer).

Fordelingen mellom kjønn er nesten helt jevn, med 2 657 menn (50,5 %) og 2 609 kvinner (49,5 %).

```{r}
# Tabell: Beskrivende statistikk for inntekt og alder etter kjønn
heights %>%
  select(kjonn, inntekt, alder) %>%
  vtable::st(
    group = "kjonn",
    group.long = TRUE,
    labels = c(
      inntekt = "Inntekt (USD)",
      alder   = "Alder (år)"
    ),
    out = "return"
  ) %>%
  as_flextable() %>%
  autofit()

# figuren for fordeling av kjønn
fordeling_kjonn <- heights %>%
  ggplot(aes(x = kjonn)) +
  geom_bar(fill = "sandybrown", color = "white") +
      geom_text(
    stat = "count",
    aes(label = after_stat(count)),
    vjust = -0.3,           # Tekst som vises over kolonnen
    size = 2,               # Skriftstørrelse
    color = "black"         # Skriftfarge
  ) +
  labs(
    title = "Fordeling av kjønn",
    x = "Kjønn",
    y = "Antall personer"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    panel.grid.major = element_line(color = "grey80", linewidth = 0.6),
    panel.grid.minor = element_blank()
  )
fordeling_kjonn
```

Variabelen kjønn beskriver fordelingen mellom menn og kvinner i datasettet.

Figuren fordeling av kjonn viser at kjønnsfordelingen av 5 266 observasjonene i datasettet er nesten helt balansert. Av de 5 266 observasjonene er det 2 657 menn og 2 609 kvinner. Forskjellen mellom gruppene er dermed svært liten, noe som betyr at analysen ikke vil være skjev med hensyn til kjønn.

```{r}
# Tabell: Beskrivende statistikk for inntekt og alder etter sivilstatus (Gift vs. Ikke gift)

heights %>%
  mutate(
    sivilgruppe = if_else(sivilstatus == "married", "Gift", "Ikke gift"),
    sivilgruppe = factor(sivilgruppe)        # Setter tydelig som faktor
  ) %>%
  select(sivilgruppe, inntekt, alder) %>%
  vtable::st(
    group         = "sivilgruppe",
    group.long    = TRUE,
    summ          = c("notNA(x)", "mean(x)", "sd(x)"),
    summ.names    = c("N", "Mean", "SD"),
    labels        = c(inntekt = "Inntekt (USD)", alder = "Alder (år)"),
    out           = "return",
    factor.numeric = TRUE                    # Viktig: hindrer advarsler
  ) %>%
  flextable::as_flextable() %>%
  flextable::set_caption("Tabell. Beskrivende statistikk for inntekt og alder etter sivilstatus (Gift vs. Ikke gift)") %>%
  flextable::autofit()


# figure
fordeling_sivilstatus <- heights %>%
  ggplot(aes(x = sivilstatus)) +
  geom_bar(fill = "tomato", color = "white") +
    geom_text(
    stat = "count",
    aes(label = ..count..),
    vjust = -0.3,           # Tekst som vises over kolonnen
    size = 2,               # Skriftstørrelse
    color = "black"         # Skriftfarge
  ) +
  labs(
    title = "Fordeling av sivilstatus",
    x = "Sivilstatus",
    y = "Antall personer"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    panel.grid.major = element_line(color = "grey80", linewidth = 0.6),
    panel.grid.minor = element_blank(),
    axis.text.x = element_text(angle = 30, hjust = 1)
  )
fordeling_sivilstatus
```

Variabelen sivilstatus viser 5266 deltakernes ekteskapsstatus og består av fem kategorier: single, married, separated, divorced og widowed.Obeservasjonene som er gift har høyere gjennomsnittsinntekt enn de som ikke er gift. Gruppen “Ikke gift” inkluderer personer som er single, skilt, separert eller enke/enkemann.

Figuren fordeling av sivilstatus viser hvordan observasjonene fordeler seg mellom disse gruppene. Det fremgår tydelig at flertallet av personene er gift (married), med 3 101 observasjoner, noe som utgjør nærmere 59 prosent av utvalget. Videre er 1 115 personer skilt (divorced) og 710 single (never married), mens kategoriene separated (233) og widowed (107) utgjør en mindre andel.

Fordelingen av sivilstatus viser dermed et mønster som er vanlig i voksenbefolkningen, der de fleste er gift eller tidligere gift.

:::

## Analysis

::: incremental
-   Første punkt 
    -Sammenhengen mellom inntekt og alder

### Sammenhengen mellom inntekt og alder
```{r}
# figuren for sammenhengen mellom inntekt og alder

sammenhengen_inntekt_alder <- heights %>%
  ggplot(aes(x = alder, y = inntekt)) +
  geom_point(alpha = 0.4, color = "lightblue") +     # Hver prikk representerer én person
  geom_smooth(method = "lm", se = TRUE, color = "red", formula = y ~ x) +
  # Legger til regresjonslinje
  scale_x_continuous(breaks = seq(47, 56, 1)) +      # Viser alle aldersintervaller på x-aksen
  scale_y_continuous(
    limits = c(0, 350000),
    breaks = seq(0, 350000, 50000),
    labels = scales::label_number(big.mark = " ")
  ) +
  labs(
    title = "Sammenhengen mellom alder og inntekt",
    x = "Alder (år)",
    y = "Inntekt (USD)"
  ) +
  theme_minimal(base_size = 14)
sammenhengen_inntekt_alder


# figuren for gjennomsnittlig inntekt etter alder
gjennomsnittlig_inntekt_alder <- heights %>%
  group_by(alder) %>%
  summarise(gjennomsnitt_inntekt = mean(inntekt), antall_personer = n()) %>%
  ggplot(aes(x = alder, y = gjennomsnitt_inntekt)) +
  geom_line(color = "steelblue", linewidth = 1) +
  geom_point(color = "red", size = 2) +
  geom_text(aes(label = antall_personer), vjust = -1, size = 3.5, color = "black") +
  labs(
    title = "Gjennomsnittlig inntekt etter alder",
    x = "Alder (år)",
    y = "Gjennomsnittlig inntekt (USD)"
  ) +
  scale_y_continuous(limits = c(35000, 65000)) +
  theme_minimal(base_size = 14)
gjennomsnittlig_inntekt_alder


# korrelasjonen mellom inntekt og alder
cor(heights$alder, heights$inntekt, use = "complete.obs")

# den enkle lineære regresjonen
regresjon_alder <- lm(inntekt ~ alder, data = heights)
summary(regresjon_alder)
 
```

-   Andre punkt
    - Sammenhengen mellom inntekt og kjønn

### Sammenhengen mellom inntekt og kjønn
```{r}
# figuren for sammenhengen mellom inntekt og kjønn
sammenhengen_inntekt_kjonn <- heights %>%
  ggplot(aes(x = kjonn, y = inntekt, fill = kjonn)) +
  geom_boxplot(alpha = 0.7, color = "gray40") +
  scale_y_continuous(labels = scales::label_number(big.mark = " ")) +
  labs(
    title = "Sammenligning av inntektsfordeling etter kjønn",
    x = "Kjønn",
    y = "Inntekt (USD)"
  ) +
  theme_minimal(base_size = 14) +
  theme(legend.position = "none")
sammenhengen_inntekt_kjonn

# Gruppegjennomsnitt, median og standardavvik
heights %>%
  group_by(kjonn) %>%
  summarise(
    gjennomsnitt_inntekt = mean(inntekt),
    median_inntekt = median(inntekt),
    sd_inntekt = sd(inntekt),
    antall_personer = n() )

#den enkle lineære regresjonen
regresjon_kjonn <- lm(inntekt ~ kjonn, data = heights)
summary(regresjon_kjonn)

```


-   Tredje punkt
    - Sammenhengen mellom inntekt og sivilstatus
    
### Sammenhengen mellom inntekt og sivilstatus
```{r}
# figuren for sammenhengen mellom inntekt og sivilstatus

sammenhengen_inntekt_sivilstatus <- heights %>%
  ggplot(aes(x = sivilstatus, y = inntekt, fill = sivilstatus)) +
  geom_boxplot(alpha = 0.7, color = "gray40") +
  scale_y_continuous(
    breaks = seq(0, 350000, 50000),
    labels = scales::label_number(big.mark = " ")
  ) +
  labs(
    title = "Sammenligning av inntektsfordeling etter sivilstatus",
    x = "Sivilstatus",
    y = "Inntekt (USD)"
  ) +
  theme_minimal(base_size = 14) +
  theme(
    legend.position = "none",
    axis.text.x = element_text(angle = 30, hjust = 1)
  )
sammenhengen_inntekt_sivilstatus

## Gruppegjennomsnitt, median og standardavvik
heights %>%
  group_by(sivilstatus) %>%
  summarise(
    gjennomsnitt_inntekt = mean(inntekt),
    median_inntekt = median(inntekt),
    sd_inntekt = sd(inntekt),
    antall_personer = n() )

#den enkle lineære regresjonen
regresjon_sivilstatus <- lm(inntekt ~ sivilstatus, data = heights)
summary(regresjon_sivilstatus)

```



:::

## Results

## Konklusjon

## References
